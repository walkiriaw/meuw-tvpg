<script>
const epgData = {
  "cartoon": [
    {
      "start": "17:09",
      "end": "17:20",
      "title": "Clarêncio, o Otimista",
      "desc": "Temporada 2 Episódio 18 - O Jogo"
    },
    {
      "start": "17:20",
      "end": "17:33",
      "title": "Clarêncio, o Otimista",
      "desc": "Temporada 2 Episódio 20 - Garota Misteriosa"
    },
    {
      "start": "17:33",
      "end": "17:44",
      "title": "Clarêncio, o Otimista",
      "desc": "Temporada 1 Episódio 20 - Os Esquecidos"
    },
    {
      "start": "17:44",
      "end": "18:06",
      "title": "Jellystone!",
      "desc": "Temporada 3 Episódio 19 - Crise nas Infinitas Risadas"
    },
    {
      "start": "18:06",
      "end": "18:19",
      "title": "Ursinhos em Curso",
      "desc": "Temporada 2 Episódio 14 - Submarino Afundado"
    },
    {
      "start": "18:19",
      "end": "18:30",
      "title": "Ursinhos em Curso",
      "desc": "Temporada 1 Episódio 13 - Dia de Fiesta"
    },
    {
      "start": "18:30",
      "end": "18:42",
      "title": "Os Jovens Titãs em Ação",
      "desc": "Temporada 9 Episódio 2 - O.S.H.A."
    },
    {
      "start": "18:42",
      "end": "18:54",
      "title": "Os Jovens Titãs em Ação",
      "desc": "Children"
    },
    {
      "start": "18:54",
      "end": "19:04",
      "title": "Os Jovens Titãs em Ação",
      "desc": "Temporada 7 Episódio 44 - Cavaleiro da TV 7"
    },
    {
      "start": "19:04",
      "end": "19:15",
      "title": "Os Jovens Titãs em Ação",
      "desc": "Children"
    },
    {
      "start": "19:15",
      "end": "19:26",
      "title": "Os Jovens Titãs em Ação",
      "desc": "Children"
    },
    {
      "start": "19:26",
      "end": "19:38",
      "title": "Big Blue",
      "desc": "Children"
    },
    {
      "start": "19:38",
      "end": "20:01",
      "title": "A Jornada Heroica do Valente Príncipe Ivandoé",
      "desc": "Temporada 2 Episódio 7"
    },
    {
      "start": "20:01",
      "end": "20:14",
      "title": "Pinecone & Pony",
      "desc": "Children"
    },
    {
      "start": "20:14",
      "end": "20:25",
      "title": "Ursinhos em Curso",
      "desc": "Temporada 1 Episódio 6 - Excaliburso"
    },
    {
      "start": "20:25",
      "end": "20:37",
      "title": "Ursinhos em Curso",
      "desc": "Temporada 2 Episódio 6 - Néctar do Rexford"
    },
    {
      "start": "20:37",
      "end": "21:02",
      "title": "Megamind Rules!",
      "desc": "Temporada 1 Episódio 1"
    },
    {
      "start": "21:02",
      "end": "22:50",
      "title": "Sing - Quem Canta Seus Males Espanta",
      "desc": "Children / 2016"
    },
    {
      "start": "22:50",
      "end": "23:02",
      "title": "Ursinhos em Curso",
      "desc": "Temporada 1 Episódio 2 - Ursos e o Pé de Feijão"
    },
    {
      "start": "23:02",
      "end": "23:14",
      "title": "Jellystone!",
      "desc": "Temporada 3 Episódio 2 - Febre de Discoteca"
    },
    {
      "start": "23:14",
      "end": "23:26",
      "title": "Jellystone!",
      "desc": "Temporada 2 Episódio 4 - Crise de Meia Idade do Zé"
    },
    {
      "start": "23:26",
      "end": "23:38",
      "title": "Jellystone!",
      "desc": "Temporada 2 Episódio 12"
    },
    {
      "start": "23:38",
      "end": "23:51",
      "title": "A Jornada Heroica do Valente Príncipe Ivandoé",
      "desc": "Temporada 4 Episódio 2 - O Príncipe e a Tristeza de Aniversário"
    },
    {
      "start": "23:51",
      "end": "00:00",
      "title": "A Jornada Heroica do Valente Príncipe Ivandoé",
      "desc": "Temporada 5 Episódio 8 - O Príncipe e o Escudeiro Magrelo"
    }
  ],
  "disckds": [
    {
      "start": "17:00",
      "end": "17:10",
      "title": "Peppa Pig",
      "desc": "Peppa visita o zoológico."
    },
    {
      "start": "17:10",
      "end": "17:25",
      "title": "Doki",
      "desc": "Doki vai à Lua com amigos."
    },
    {
      "start": "17:25",
      "end": "17:55",
      "title": "My Little Pony",
      "desc": "Twilight enfrenta um dilema mágico."
    },
    {
      "start": "17:55",
      "end": "18:25",
      "title": "Backyardigans",
      "desc": "Missão no fundo do mar."
    },
    {
      "start": "18:25",
      "end": "18:40",
      "title": "Pocoyo",
      "desc": "Pocoyo aprende sobre cores."
    }
  ],
  "disneychan": [
    {
      "start": "17:00",
      "end": "17:20",
      "title": "Phineas e Ferb",
      "desc": "Phineas constrói uma montanha-russa."
    },
    {
      "start": "17:20",
      "end": "17:42",
      "title": "Gravity Falls",
      "desc": "Dipper investiga um mistério."
    },
    {
      "start": "17:42",
      "end": "18:07",
      "title": "Jessie",
      "desc": "Jessie perde o cachorro dos meninos."
    },
    {
      "start": "18:07",
      "end": "18:37",
      "title": "DuckTales",
      "desc": "Tio Patinhas busca um tesouro."
    }
  ],
  "gloob": [
    {
      "start": "17:00",
      "end": "17:22",
      "title": "Miraculous",
      "desc": "Ladybug enfrenta novo vilão."
    },
    {
      "start": "17:22",
      "end": "17:52",
      "title": "DPA",
      "desc": "Os detetives resolvem o caso da múmia."
    },
    {
      "start": "17:52",
      "end": "18:12",
      "title": "Bugados",
      "desc": "O jogo ficou real demais!"
    }
  ],
  "nickjr": [
    {
      "start": "17:00",
      "end": "17:12",
      "title": "Patrulha Canina",
      "desc": "Filhotes salvam um trem."
    },
    {
      "start": "17:12",
      "end": "17:27",
      "title": "Dora",
      "desc": "Dora encontra o mapa na floresta."
    },
    {
      "start": "17:27",
      "end": "17:47",
      "title": "Blaze",
      "desc": "Corrida na selva!"
    }
  ],
  "nickelodeon": [
    {
      "start": "17:00",
      "end": "17:15",
      "title": "Bob Esponja",
      "desc": "Bob abre um restaurante de areia."
    },
    {
      "start": "17:15",
      "end": "17:35",
      "title": "Loud House",
      "desc": "Lincoln tenta estudar em silêncio."
    },
    {
      "start": "17:35",
      "end": "18:00",
      "title": "Os Thundermans",
      "desc": "Phoebe quer esconder os poderes."
    },
    {
      "start": "18:00",
      "end": "18:30",
      "title": "iCarly",
      "desc": "Carly transmite do porão."
    }
  ]
};

function updateEPGBlock(channel, list) {
  const now = new Date();
  const currentTime = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');

  for (const item of list) {
    if (currentTime >= item.start && currentTime < item.end) {
      const [sh, sm] = item.start.split(':'), [eh, em] = item.end.split(':');
      const startMin = parseInt(sh) * 60 + parseInt(sm);
      const endMin = parseInt(eh) * 60 + parseInt(em);
      const nowMin = now.getHours() * 60 + now.getMinutes();
      const progress = Math.max(0, Math.min(((nowMin - startMin) / (endMin - startMin)) * 100, 100));

      const hora = document.getElementById(`epg-hora-${channel}`);
      const titulo = document.getElementById(`epg-titulo-${channel}`);
      const desc = document.getElementById(`epg-desc-${channel}`);
      const progressBar = document.getElementById(`epg-progress-${channel}`);

      if (hora) hora.textContent = item.start;
      if (titulo) titulo.textContent = item.title;
      if (desc) desc.textContent = item.desc;
      if (progressBar) progressBar.style.width = `${progress}%`;
    }
  }
}

function updateAllEPG() {
  for (const channel in epgData) {
    updateEPGBlock(channel, epgData[channel]);
  }
}

updateAllEPG();
setInterval(updateAllEPG, 60000);
</script>
